name: Check for Updates

on:
  schedule:
    # æ¯æ—¥åˆå‰3æ™‚ï¼ˆUTCï¼‰ã«å®Ÿè¡Œ
    - cron: '0 3 * * *'
  workflow_dispatch: # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½

jobs:
  check-updates:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v6

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: Check for outdated packages
        run: |
          npm outdated || true
          
      - name: Create issue if updates available
        uses: actions/github-script@v7
        if: failure()
        with:
          script: |
            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: 'ğŸ“¦ ä¾å­˜é–¢ä¿‚ã®æ›´æ–°ãŒå¿…è¦ã§ã™',
              body: 'ä¾å­˜é–¢ä¿‚ã«æ›´æ–°ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚`npm update`ã‚’å®Ÿè¡Œã—ã¦ç¢ºèªã—ã¦ãã ã•ã„ã€‚',
              labels: ['dependencies', 'maintenance']
            })

