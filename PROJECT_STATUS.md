# プロジェクト実装状況

## 完了項目 ✅

### フロントエンド

- [x] プロジェクト構造の整理
- [x] 型定義の作成
- [x] 住民向けLIFFアプリ
  - [x] LIFF初期化・認証
  - [x] 通報フォーム（位置情報、カテゴリ、写真、詳細、連絡先）
  - [x] 避難所マップ（暫定実装、Leafletパッケージ必要）
  - [x] 緊急通報ボタン
- [x] 職員向け管理Web
  - [x] ログイン画面（Cognito認証、暫定実装）
  - [x] ダッシュボード（リスト・地図表示）
  - [x] フィルタ・ソート・検索機能
  - [x] 詳細パネル（写真、詳細、メモ、ステータス更新）
  - [x] CSV出力機能
- [x] APIクライアント実装
- [x] ルーティング設定
- [x] 画像圧縮（クライアント側）
- [x] 地図（Leaflet）本実装（避難所/通報/ピンドラッグ）
- [x] Cognito認証（Amplify v6、MFA対応）

### ドキュメント

- [x] README作成
- [x] セットアップガイド
- [x] インフラ構築ガイド
- [x] Lambda関数実装ガイド
### バックエンド（Lambda）

- [x] LIFF IDトークン検証（JWT/JWKS）
- [x] Cognito JWT検証（JWT/JWKS、role: viewer/operator/admin）
- [x] 通報CRUD（作成/一覧/詳細/ステータス/メモ/履歴）
- [x] 連絡先閲覧の監査ログ（VIEW_CONTACT）
- [x] 画像アップロード/閲覧（署名付きURL：PUT/GET）
- [x] レート制限（DynamoDB TTLを利用したスロットリング）
- [x] 監査ログ（AuditLogs）
- [x] 通知フック（SNS_TOPIC_ARNが設定されている場合にPublish）

### インフラ（SAM）

- [x] SAMテンプレート追加（API/DynamoDB/S3/Cognito、グループ作成）

## 未実装項目 ⏳

### バックエンド（Lambda）

- [ ] LIFF認証実装
- [ ] （運用）入力検証の強化（画像MIME/拡張子/サイズのサーバ側検証、重複抑制の高度化）

### データベース（DynamoDB）

- [ ] Reportsテーブル作成
- [ ] ReportHistoryテーブル作成
- [ ] Sheltersテーブル作成
- [ ] GSI（Global Secondary Index）設定
 - [ ] RateLimits / AuditLogs テーブル作成

### インフラ

- [ ] （環境構築）SAMの適用・環境分離（dev/stg/prod）
- [ ] CloudFront/WAF/KMS/監視（CloudWatchアラート）など運用要件の拡張

### セキュリティ

- [ ] レート制限（WAF + サーバ側）
- [ ] 画像検証（形式・容量・枚数）
- [ ] 重複抑制ロジック
- [ ] 連絡先保護のより厳格な運用（表示理由/表示ログの検索性など）

### 機能追加

- [ ] 地図上でのピンドラッグ（位置調整）
- [ ] 画像圧縮（クライアント側）
- [ ] MFA認証（Cognito）
- [ ] 権限管理（Viewer/Operator/Admin）
- [ ] 通知機能（新規通報時の通知）

## 次のステップ

1. **バックエンド実装**
   - Lambda関数の実装
   - DynamoDBテーブルの作成
   - API Gatewayの設定

2. **インフラ構築**
   - AWSリソースの作成
   - セキュリティ設定
   - 監視設定

3. **テスト**
   - 単体テスト
   - 統合テスト
   - E2Eテスト

4. **デプロイ**
   - 開発環境
   - ステージング環境
   - 本番環境

## 注意事項

- Leafletパッケージがインストールされていない場合、地図機能は動作しません
- Cognito認証はAWS Amplify v6（`aws-amplify`）で実装しています
- バックエンドAPIが実装されていない場合、フロントエンドは動作しません

## 実装優先順位

1. **最優先**: バックエンドAPI（Lambda）の実装
2. **高**: DynamoDBテーブルの作成
3. **高**: 認証実装（LIFF、Cognito）
4. **中**: インフラ構築
5. **中**: セキュリティ対策
6. **低**: 機能追加・改善

